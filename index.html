<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM ç¢³è¶³è·¡è©•ä¼°å·¥å…·</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
        }
        .tab-content {
            transition: opacity 0.3s ease-in-out;
        }
        .tab-content.hidden {
            opacity: 0;
            display: none;
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #1F2937;
            color: #fff;
            text-align: center;
            border-radius: 0.5rem;
            padding: 0.75rem;
            position: absolute;
            z-index: 10;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            font-size: 0.875rem;
            box-shadow: 0 5px 15px -3px rgba(0, 0, 0, 0.2);
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
            transform: translateY(-5px);
        }
        .info-icon {
            cursor: pointer;
            margin-left: 8px;
            color: #A0AEC0;
            transition: color 0.3s;
        }
        .info-icon:hover {
            color: #14B8A6;
        }
        .input-field:read-only, .input-field:disabled {
            background-color: #F1F5F9;
            color: #64748B;
        }
        .dark .input-field:read-only, .dark .input-field:disabled {
            background-color: #4B5563;
            color: #9CA3AF;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-6xl bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden">
        <header class="p-6 bg-gray-50 dark:bg-gray-700/50">
            <h1 class="text-2xl font-bold text-center text-gray-900 dark:text-white">LLM ç¢³è¶³è·¡è©•ä¼°å·¥å…·</h1>
            <p class="text-sm text-center text-gray-500 dark:text-gray-400 mt-1">æ•´åˆ LLM è¨“ç·´ã€æ¨è«–åŠç¡¬é«”ç”Ÿå‘½é€±æœŸçš„ç¢³æ’è¨ˆç®—</p>
            <p class="text-xs text-center text-gray-400 dark:text-gray-500 mt-2">Developed By é»ƒå­ç‘„</p>
        </header>

        <!-- æ›¸ç±¤å¼é ç±¤å°è¦½åˆ— -->
        <div class="border-b border-gray-200 dark:border-gray-700">
            <nav class="-mb-px flex" aria-label="Tabs" id="tab-buttons">
                <button class="tab-button active-tab group w-1/3 inline-flex items-center justify-center py-4 px-1 border-b-2 font-medium text-sm text-indigo-600 dark:text-indigo-400 border-indigo-500" data-tab="tool1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-12h2v6h-2v-6zm0 8h2v2h-2v-2z"/>
                    </svg>
                    AI æ™¶ç‰‡ LCA
                </button>
                <button class="tab-button inactive-tab group w-1/3 inline-flex items-center justify-center py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-500" data-tab="tool2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                    </svg>
                    LLM è¨“ç·´ç¢³æ’
                </button>
                <button class="tab-button inactive-tab group w-1/3 inline-flex items-center justify-center py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-500" data-tab="tool3">
                     <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
                    </svg>
                    LLM æ¨è«–ç¢³æ’
                </button>
            </nav>
        </div>

        <!-- å·¥å…·å…§å®¹å€åŸŸ -->
        <div class="p-6 md:p-8 min-h-[500px]">
            <!-- å·¥å…· 1: AI æ™¶ç‰‡ LCA è©•ä¼° -->
            <div id="tool1" class="tab-content">
                 <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
                    <div class="p-2">
                        <h2 class="text-2xl font-semibold mb-6 border-b-2 border-gray-200 dark:border-gray-600 pb-4">åƒæ•¸è¨­å®š</h2>
                        <div class="mb-6">
                            <label for="gpuChip" class="block text-gray-700 dark:text-gray-300 font-bold mb-2">é¸æ“‡ AI æ™¶ç‰‡æ¨¡å‹</label>
                            <div class="relative">
                                <select id="gpuChip" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 appearance-none bg-white dark:bg-gray-700">
                                    <option value="A100">NVIDIA A100</option>
                                    <option value="H100">NVIDIA H100</option>
                                    <option value="B200">NVIDIA B200</option>
                                    <option value="B300">NVIDIA B300</option>
                                </select>
                                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700 dark:text-gray-300">
                                    <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15 9.707l-1.414-1.414L10 11.586l-3.586-3.586L5 9.707z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-6">
                            <div>
                                <label for="lifespan" class="block text-gray-700 dark:text-gray-300 font-bold mb-2">é ä¼°ä½¿ç”¨å¹´é™ (å¹´)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">AI æ™¶ç‰‡åœ¨è³‡æ–™ä¸­å¿ƒæˆ–ä¼ºæœå™¨ç’°å¢ƒä¸­çš„å…¸å‹é‹ä½œå£½å‘½ï¼Œé€šå¸¸ç‚º 5 å¹´ã€‚</span></span></label>
                                <input type="number" id="lifespan" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="5" min="1">
                            </div>
                            <div>
                                <label for="utilization" class="block text-gray-700 dark:text-gray-300 font-bold mb-2">æ¯æ—¥é‹ä½œæ™‚æ•¸ (å°æ™‚)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">AI æ™¶ç‰‡åœ¨ä¸€å¤©ä¸­é€²è¡Œè¨“ç·´æˆ–æ¨è«–ä»»å‹™çš„å¹³å‡æ™‚é–“ï¼Œå»ºè­°å€¼ç‚º 24 å°æ™‚ã€‚</span></span></label>
                                <input type="number" id="utilization" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="24" min="0" max="24">
                            </div>
                        </div>
                        <div class="mb-6">
                            <label for="carbonIntensity" class="block text-gray-700 dark:text-gray-300 font-bold mb-2">é›»ç¶²ç¢³å¼·åº¦ (kgCOâ‚‚e/kWh)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¯ç”¢ç”Ÿä¸€åº¦é›»æ‰€ç”¢ç”Ÿçš„ç¢³æ’æ”¾é‡ã€‚å°ç£ 2022 å¹´å¹³å‡å€¼ç´„ç‚º 0.416 kgCOâ‚‚e/kWhã€‚</span></span></label>
                            <input type="number" id="carbonIntensity" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="0.416" step="0.001">
                        </div>
                        <div class="text-center mt-8">
                            <button id="calculateLcaBtn" class="w-full bg-gradient-to-r from-blue-600 to-teal-500 text-white font-bold py-4 px-8 rounded-xl hover:from-blue-700 hover:to-teal-600 transition-all duration-300 text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1">é–‹å§‹è¨ˆç®—</button>
                        </div>
                    </div>
                    <div id="lca-results-container" class="p-2">
                        <h2 class="text-2xl font-semibold mb-6 border-b-2 border-gray-200 dark:border-gray-600 pb-4">è¨ˆç®—çµæœ</h2>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                            <div class="bg-emerald-50 dark:bg-emerald-900/50 p-4 rounded-xl flex flex-col items-center justify-center text-center transition hover:scale-105 border border-emerald-200 dark:border-emerald-800">
                                <span role="img" aria-label="cloud-with-emissions" class="text-4xl mb-2">ğŸ’¨</span>
                                <h4 class="font-medium text-emerald-800 dark:text-emerald-200 mb-2">ç¸½ç¢³è¶³è·¡<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ™¶ç‰‡åœ¨æ•´å€‹ç”Ÿå‘½é€±æœŸä¸­ç”¢ç”Ÿçš„æº«å®¤æ°£é«”ç¸½æ’æ”¾é‡ï¼ŒåŒ…å«è£½é€ èˆ‡é‹ä½œéšæ®µã€‚</span></span></h4>
                                <p id="totalCo2" class="text-3xl font-bold text-emerald-900 dark:text-emerald-100">0.00 <span class="text-base font-normal">tCOâ‚‚eq</span></p>
                            </div>
                            <div class="bg-sky-50 dark:bg-sky-900/50 p-4 rounded-xl flex flex-col items-center justify-center text-center transition hover:scale-105 border border-sky-200 dark:border-sky-800">
                                <span role="img" aria-label="water-droplet" class="text-4xl mb-2">ğŸ’§</span>
                                <h4 class="font-medium text-sky-800 dark:text-sky-200 mb-2">æ°´è³‡æºæ¶ˆè€—<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ™¶ç‰‡åœ¨å…¶ä½¿ç”¨å£½å‘½å…§ï¼Œæ–¼è£½é€ åŠé‹ä½œéç¨‹ä¸­æ¶ˆè€—çš„ç¸½æ°´é‡ã€‚</span></span></h4>
                                <p id="waterConsumption" class="text-3xl font-bold text-sky-900 dark:text-sky-100">0 <span class="text-base font-normal">L</span></p>
                            </div>
                            <div class="bg-lime-50 dark:bg-lime-900/50 p-4 rounded-xl flex flex-col items-center justify-center text-center transition hover:scale-105 border border-lime-200 dark:border-lime-800">
                                <span role="img" aria-label="waste-bin" class="text-4xl mb-2">ğŸ—‘ï¸</span>
                                <h4 class="font-medium text-lime-800 dark:text-lime-200 mb-2">é›»å­å»¢æ£„ç‰©<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ™¶ç‰‡åœ¨ç”Ÿå‘½é€±æœŸçµæŸå¾Œç”¢ç”Ÿçš„å»¢æ£„ç‰©é‡é‡ï¼Œé€šå¸¸æŒ‡ç”¢å“æœ¬èº«çš„é‡é‡ã€‚</span></span></h4>
                                <p id="eWaste" class="text-3xl font-bold text-lime-900 dark:text-lime-100">0.00 <span class="text-base font-normal">kg</span></p>
                            </div>
                        </div>
                        <div class="border-t pt-6 mt-6 space-y-6">
                            <h3 class="text-lg font-semibold text-gray-600 dark:text-gray-300 mb-3">ç¢³æ’ç´°é …åˆ†æ</h3>
                            <div class="grid grid-cols-2 gap-4 text-center">
                                <div class="bg-blue-100 dark:bg-blue-900/50 p-4 rounded-xl border border-blue-200 dark:border-blue-800 flex flex-col justify-center transition hover:scale-105">
                                    <h4 class="font-medium text-blue-800 dark:text-blue-200">ç‡Ÿé‹ç¢³æ’<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ™¶ç‰‡åœ¨é‹ä½œæœŸé–“ï¼Œå› é›»åŠ›æ¶ˆè€—æ‰€ç”¢ç”Ÿçš„ç¢³æ’ã€‚</span></span></h4>
                                    <p id="operationalCo2" class="text-2xl font-semibold text-blue-900 dark:text-blue-100">0.00 <span class="text-base font-normal">tCOâ‚‚eq</span></p>
                                </div>
                                <div class="bg-teal-100 dark:bg-teal-900/50 p-4 rounded-xl border border-teal-200 dark:border-teal-800 flex flex-col justify-center transition hover:scale-105">
                                    <h4 class="font-medium text-teal-800 dark:text-teal-200">éš±å«ç¢³æ’<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ™¶ç‰‡åœ¨è£½é€ ã€é‹è¼¸åŠæ£„ç½®éšæ®µæ‰€ç”¢ç”Ÿçš„ç¢³æ’ã€‚</span></span></h4>
                                    <p id="embodiedCo2" class="text-2xl font-semibold text-teal-900 dark:text-teal-100">0.00 <span class="text-base font-normal">tCOâ‚‚eq</span></p>
                                </div>
                            </div>
                            <div class="max-w-xs mx-auto mb-6"><canvas id="carbonChart"></canvas></div>
                            <div>
                                <h3 class="text-lg font-semibold text-gray-600 dark:text-gray-300 mb-3">æ—¥å¸¸æ›ç®—</h3>
                                <div id="lca-equivalents" class="grid grid-cols-2 lg:grid-cols-4 gap-4"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å·¥å…· 2: LLM è¨“ç·´ç¢³æ’è¨ˆç®—å™¨ -->
            <div id="tool2" class="tab-content hidden">
                 <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
                    <div class="p-2">
                        <h2 class="text-2xl font-semibold mb-6 border-b-2 border-gray-200 dark:border-gray-600 pb-4">åƒæ•¸è¨­å®š</h2>
                        <section>
                            <h3 class="text-xl font-semibold text-blue-600 dark:text-blue-400 mb-4">1. LLM æ¨¡å‹è¨­å®š</h3>
                            <div class="space-y-4">
                                <div>
                                    <label for="modelPreset" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">æ¨¡å‹é è¨­</label>
                                    <select id="modelPreset" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 bg-white">
                                    </select>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label for="modelType" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">æ¨¡å‹é¡å‹</label>
                                        <select id="modelType" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 bg-white">
                                            <option value="dense">Dense (å¯†é›†æ¨¡å‹)</option>
                                            <option value="MoE">MoE (å°ˆå®¶æ··åˆæ¨¡å‹)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="parametersB" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ç¸½åƒæ•¸æ•¸é‡ (B)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¨¡å‹çš„ç¸½åƒæ•¸æ•¸é‡ï¼Œå–®ä½ç‚ºåå„„ (Billion)ã€‚</span></span></label>
                                        <input type="number" id="parametersB" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600">
                                    </div>
                                    <div id="baseModelParamsContainer" class="hidden">
                                        <label for="baseModelParamsB" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">åŸºç¤æ¨¡å‹åƒæ•¸ (B)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">å°æ–¼ MoE æ¨¡å‹ï¼Œå…¶å°æ‡‰çš„å¯†é›†åŸºç¤æ¨¡å‹åƒæ•¸æ•¸é‡ã€‚</span></span></label>
                                        <input type="number" id="baseModelParamsB" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600">
                                    </div>
                                    <div>
                                        <label for="tokensB" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">è™•ç† Token æ•¸é‡ (B)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¨¡å‹åœ¨è¨“ç·´æˆ–æ¨è«–éç¨‹ä¸­è™•ç†çš„ Token ç¸½æ•¸ï¼Œå–®ä½ç‚ºåå„„ (Billion)ã€‚</span></span></label>
                                        <input type="number" id="tokensB" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600">
                                    </div>
                                </div>
                            </div>
                        </section>
                        <section class="mt-6">
                            <h3 class="text-xl font-semibold text-sky-600 dark:text-sky-400 mb-4">2. ç¡¬é«”èˆ‡è³‡æ–™ä¸­å¿ƒè¨­å®š</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="deviceType" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">é‹ç®—è£ç½®</label>
                                    <select id="deviceType" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 bg-white">
                                        <option value="V100">NVIDIA V100</option>
                                        <option value="A100">NVIDIA A100</option>
                                        <option value="H100">NVIDIA H100</option>
                                        <option value="TPUv3">Google TPUv3</option>
                                        <option value="TPUv4">Google TPUv4</option>
                                        <option value="custom">è‡ªè¨‚</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="deviceNum" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">è£ç½®æ•¸é‡</label>
                                    <input type="number" id="deviceNum" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="10000">
                                </div>
                                <div>
                                    <label for="systemPower" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">å¹³å‡ç³»çµ±åŠŸè€— (W/è£ç½®)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¯å°é‹ç®—è£ç½®ï¼ˆåŒ…å«ä¸»æ©Ÿã€è¨˜æ†¶é«”ç­‰ï¼‰çš„å¹³å‡ç¸½åŠŸè€—ã€‚</span></span></label>
                                    <input type="number" id="systemPower" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="330">
                                </div>
                                <div>
                                    <label for="hardwareEfficiency" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ç¡¬é«”æ•ˆç‡ (%)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">å¯¦éš›é‹ç®—ååé‡ç›¸å°æ–¼ç†è«–å³°å€¼ååé‡çš„ç™¾åˆ†æ¯”ã€‚</span></span></label>
                                    <input type="number" id="hardwareEfficiency" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="19.7" step="0.1">
                                </div>
                                <div>
                                    <label for="pue" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">PUE<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">é›»åŠ›ä½¿ç”¨æ•ˆç‡ (Power Usage Effectiveness)ï¼Œè³‡æ–™ä¸­å¿ƒç¸½è€—èƒ½èˆ‡ IT è¨­å‚™è€—èƒ½çš„æ¯”å€¼ï¼Œè¶Šæ¥è¿‘ 1 æ•ˆç‡è¶Šé«˜ã€‚</span></span></label>
                                    <input type="number" id="pue" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="1.1" step="0.01">
                                </div>
                                <div>
                                    <label for="trainingCo2eqkwh" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ç¢³å¼·åº¦ (kgCOâ‚‚eq/kWh)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">è³‡æ–™ä¸­å¿ƒæ¯æ¶ˆè€—ä¸€åº¦é›»ï¼ˆkWhï¼‰æ‰€ç”¢ç”Ÿçš„äºŒæ°§åŒ–ç¢³ç•¶é‡(å…¬æ–¤)ã€‚é è¨­å€¼ç‚ºç¾åœ‹å¹³å‡ã€‚</span></span></label>
                                    <input type="number" id="trainingCo2eqkwh" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="0.429" step="0.001">
                                </div>
                                <div class="md:col-span-2">
                                     <label for="gpuCostPerHour" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">GPU å–®ä½æˆæœ¬ ($/å°æ™‚)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">å–®ä¸€ GPU æ¯å°æ™‚çš„é‹ç®—æˆæœ¬ã€‚é è¨­å€¼åƒè€ƒ Microsoft Azure V100 éš¨ç”¨éš¨ä»˜åƒ¹æ ¼ã€‚</span></span></label>
                                    <input type="number" id="gpuCostPerHour" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="3.09" step="0.01">
                               </div>
                            </div>
                        </section>
                        <div class="text-center mt-8">
                            <button id="calculateTrainingBtn" class="w-full bg-gradient-to-r from-blue-600 to-teal-500 text-white font-bold py-4 px-8 rounded-xl hover:from-blue-700 hover:to-teal-600 transition-all duration-300 text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1">é–‹å§‹è¨ˆç®—</button>
                        </div>
                    </div>
                    <div id="training-results-container" class="p-2 hidden">
                        <h2 class="text-2xl font-semibold mb-6 border-b-2 border-gray-200 dark:border-gray-600 pb-4">è¨ˆç®—çµæœ</h2>
                        <div class="space-y-6">
                            <div id="key-metrics" class="grid grid-cols-2 gap-4 text-center">
                                <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg border dark:border-gray-600">
                                    <h4 class="text-md font-medium text-gray-800 dark:text-gray-300">è¨“ç·´ç¢³æ’<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¨¡å‹è¨“ç·´æœŸé–“ï¼Œå› é›»åŠ›æ¶ˆè€—æ‰€ç”¢ç”Ÿçš„ç¢³æ’ã€‚</span></span></h4>
                                    <p id="operationalCo2Display" class="text-2xl font-bold text-blue-700 dark:text-blue-400 mt-2">0.00 <span class="text-base font-normal">tCOâ‚‚eq</span></p>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg border dark:border-gray-600">
                                    <h4 class="text-md font-medium text-gray-800 dark:text-gray-300">ç¸½æ¶ˆè€—é›»é‡<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¨¡å‹è¨“ç·´æœŸé–“ï¼Œè³‡æ–™ä¸­å¿ƒç¸½å…±æ¶ˆè€—çš„é›»é‡ã€‚</span></span></h4>
                                    <p id="totalEnergyMWhDisplay" class="text-2xl font-bold text-sky-700 dark:text-sky-400 mt-2">0.00 <span class="text-base font-normal">MWh</span></p>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg border dark:border-gray-600">
                                    <h4 class="text-md font-medium text-gray-800 dark:text-gray-300">é ä¼°è¨“ç·´æ™‚é–“<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¨¡å‹å®Œæˆè¨“ç·´æ‰€éœ€çš„ç¸½æ™‚é–“ã€‚</span></span></h4>
                                    <p id="trainingDurationDisplay" class="text-2xl font-bold text-indigo-700 dark:text-indigo-400 mt-2">0.00 å¤©</p>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg border dark:border-gray-600">
                                    <h4 class="text-md font-medium text-gray-800 dark:text-gray-300">é ä¼°è¨“ç·´æˆæœ¬<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¨¡å‹è¨“ç·´æœŸé–“æ‰€éœ€çš„ç¡¬é«”ç§Ÿç”¨æˆæœ¬ (USD)ã€‚</span></span></h4>
                                    <p id="trainingCostDisplay" class="text-2xl font-bold text-purple-700 dark:text-purple-400 mt-2">$0</p>
                                </div>
                            </div>
                            <div class="border-t dark:border-gray-600 pt-6 mt-6">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-600 dark:text-gray-300 mb-3">æ—¥å¸¸æ›ç®—</h3>
                                    <div id="training-equivalents" class="grid grid-cols-2 gap-4">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å·¥å…· 3: LLM æ¨è«–ç¢³æ’è¨ˆç®—å™¨ -->
            <div id="tool3" class="tab-content hidden">
                 <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
                    <div class="p-2">
                        <h2 class="text-2xl font-semibold mb-6 border-b-2 border-gray-200 dark:border-gray-600 pb-4">åƒæ•¸è¨­å®š</h2>
                        <section>
                            <h3 class="text-xl font-semibold text-blue-700 dark:text-blue-400 mb-4">1. LLM æ¨¡å‹è¨­å®š</h3>
                            <div class="space-y-4">
                                <div>
                                    <label for="inf-modelPreset" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">é¸æ“‡é è¨­æ¨¡å‹</label>
                                    <select id="inf-modelPreset" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 bg-white">
                                        <option value="GPT3" selected>GPT3</option>
                                        <option value="GPT4">GPT4</option>
                                        <option value="custom">è‡ªè¨‚</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="inf-tokensT" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">è™•ç† Token æ•¸é‡<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ ¹æ“šå¸¸è¦‹ä»»å‹™é¡å‹é è¨­çš„ Token æ•¸é‡ã€‚</span></span></label>
                                    <select id="inf-tokensT" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 bg-white">
                                        <option value="5e-9">å•ç­” (RAG) (ç´„ 5k tokens)</option>
                                        <option value="5e-8">ç¿»è­¯ (ç´„ 50k tokens)</option>
                                        <option value="2e-8">ç¨‹å¼ç¢¼ç”Ÿæˆ/Debug (ç´„ 20k tokens)</option>
                                        <option value="1.5e-7">æ–‡ä»¶æ‘˜è¦ (ç´„ 150k tokens)</option>
                                    </select>
                                </div>
                                <div id="inf-customModelSection" class="pt-2 hidden space-y-4">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label for="inf-modelType" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">æ¨¡å‹é¡å‹</label>
                                            <select id="inf-modelType" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 bg-white">
                                                <option value="dense">Dense (å¯†é›†æ¨¡å‹)</option>
                                                <option value="MoE">MoE (å°ˆå®¶æ··åˆæ¨¡å‹)</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label for="inf-parametersB" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ç¸½åƒæ•¸æ•¸é‡ (B)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¨¡å‹çš„ç¸½åƒæ•¸æ•¸é‡ï¼Œå–®ä½ç‚ºåå„„ (Billion)ã€‚</span></span></label>
                                            <input type="number" id="inf-parametersB" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="175" min="0">
                                        </div>
                                        <div id="inf-baseModelParamsContainer" class="hidden">
                                            <label for="inf-baseModelParamsB" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">åŸºç¤æ¨¡å‹åƒæ•¸ (B)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">å°æ–¼ MoE æ¨¡å‹ï¼Œå…¶å°æ‡‰çš„å¯†é›†åŸºç¤æ¨¡å‹åƒæ•¸æ•¸é‡ã€‚</span></span></label>
                                            <input type="number" id="inf-baseModelParamsB" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="2.3" min="0">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <section class="mt-6">
                            <h3 class="text-xl font-semibold text-teal-700 dark:text-teal-400 mb-4">2. ç¡¬é«”èˆ‡è³‡æ–™ä¸­å¿ƒè¨­å®š</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="inf-deviceType" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">é‹ç®—è£ç½®</label>
                                    <select id="inf-deviceType" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 bg-white">
                                        <option value="V100">NVIDIA V100</option>
                                        <option value="H100">NVIDIA H100</option>
                                        <option value="A100">NVIDIA A100</option>
                                        <option value="TPUv3">Google TPUv3</option>
                                        <option value="TPUv4">Google TPUv4</option>
                                        <option value="custom">è‡ªè¨‚</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="inf-deviceNum" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">è£ç½®æ•¸é‡</label>
                                    <input type="number" id="inf-deviceNum" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="10000" min="0">
                                </div>
                                <div>
                                    <label for="inf-systemPower" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">å¹³å‡ç³»çµ±åŠŸè€— (W/è£ç½®)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¯å°é‹ç®—è£ç½®ï¼ˆåŒ…å«ä¸»æ©Ÿã€è¨˜æ†¶é«”ç­‰ï¼‰çš„å¹³å‡ç¸½åŠŸè€—ã€‚</span></span></label>
                                    <input type="number" id="inf-systemPower" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="330" min="0">
                                </div>
                                <div>
                                    <label for="inf-hardwareEfficiency" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ç¡¬é«”æ•ˆç‡ (%)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">å¯¦éš›é‹ç®—ååé‡ç›¸å°æ–¼ç†è«–å³°å€¼ååé‡çš„ç™¾åˆ†æ¯”ã€‚</span></span></label>
                                    <input type="number" id="inf-hardwareEfficiency" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="19.7" step="0.1" min="0" max="100">
                                </div>
                                <div>
                                    <label for="inf-pue" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">PUE<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">é›»åŠ›ä½¿ç”¨æ•ˆç‡ (Power Usage Effectiveness)ï¼Œè³‡æ–™ä¸­å¿ƒç¸½è€—èƒ½èˆ‡ IT è¨­å‚™è€—èƒ½çš„æ¯”å€¼ï¼Œè¶Šæ¥è¿‘ 1 æ•ˆç‡è¶Šé«˜ã€‚</span></span></label>
                                    <input type="number" id="inf-pue" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="1.1" step="0.01" min="1">
                                </div>
                                <div>
                                    <label for="inf-co2eqkwh" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ç¢³å¼·åº¦ (gCOâ‚‚eq/kWh)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">è³‡æ–™ä¸­å¿ƒæ¯æ¶ˆè€—ä¸€åº¦é›»ï¼ˆkWhï¼‰æ‰€ç”¢ç”Ÿçš„äºŒæ°§åŒ–ç¢³ç•¶é‡ã€‚é è¨­å€¼ç‚ºç¾åœ‹å¹³å‡ã€‚</span></span></label>
                                    <input type="number" id="inf-co2eqkwh" class="input-field w-full p-3 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600" value="429" min="0">
                                </div>
                            </div>
                        </section>
                        <div class="text-center mt-8">
                           <button id="calculateInferenceBtn" class="w-full bg-gradient-to-r from-blue-600 to-teal-500 text-white font-bold py-4 px-8 rounded-xl hover:from-blue-700 hover:to-teal-600 transition-all duration-300 text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1">é–‹å§‹è¨ˆç®—</button>
                        </div>
                    </div>
                    <div id="inf-results-container" class="p-2 hidden">
                        <h2 class="text-2xl font-semibold mb-6 border-b-2 border-gray-200 dark:border-gray-600 pb-4">è¨ˆç®—çµæœ</h2>
                        <div class="space-y-6">
                            <div class="text-center">
                                <h3 class="text-lg font-semibold text-gray-600 dark:text-gray-300">ç¸½ç¢³è¶³è·¡ (gCOâ‚‚eq)<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¨¡å‹åœ¨æ¨è«–ä»»å‹™ä¸­ï¼Œå› é›»åŠ›æ¶ˆè€—æ‰€ç”¢ç”Ÿçš„ç¸½ç¢³æ’ã€‚</span></span></h3>
                                <p id="inf-totalCo2" class="text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-teal-500 my-2">0.00</p>
                            </div>
                            <div class="border-t pt-6 mt-6 space-y-6">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-600 dark:text-gray-300 mb-3">è©³ç´°è³‡è¨Š</h3>
                                    <div id="inf-details" class="grid grid-cols-2 gap-4">
                                        <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg border flex flex-col justify-center text-center">
                                            <h4 class="text-md font-medium text-gray-700 dark:text-gray-300 mb-2">é ä¼°æ¨è«–æ™‚é–“<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¨¡å‹å®Œæˆæ¨è«–æ‰€éœ€çš„ç¸½æ™‚é–“ã€‚</span></span></h4>
                                            <p class="text-2xl font-bold text-gray-800 dark:text-gray-200" id="inf-timeDisplay"></p>
                                        </div>
                                        <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg border flex flex-col justify-center text-center">
                                            <h4 class="text-md font-medium text-gray-700 dark:text-gray-300 mb-2">ç¸½æ¶ˆè€—é›»é‡<span class="tooltip"><svg class="info-icon inline w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="tooltiptext">æ¨¡å‹æ¨è«–æœŸé–“ï¼Œè³‡æ–™ä¸­å¿ƒç¸½å…±æ¶ˆè€—çš„é›»é‡ã€‚</span></span></h4>
                                            <p class="text-2xl font-bold text-gray-800 dark:text-gray-200" id="inf-energyDisplay"></p>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-600 dark:text-gray-300 mb-3">æ—¥å¸¸æ›ç®—</h3>
                                    <div id="inf-equivalents" class="grid grid-cols-2 gap-4">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- é€šç”¨å‡½å¼ ---
            function showAppModal(message) {
                const oldModal = document.getElementById('alert-modal');
                if (oldModal) oldModal.remove();
                const modal = document.createElement('div');
                modal.id = 'alert-modal';
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 transition-opacity duration-300 opacity-0';
                modal.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 w-11/12 md:w-1/3 transform scale-95 transition-transform duration-300">
                        <h3 class="text-xl font-bold text-red-600 mb-4">è¼¸å…¥éŒ¯èª¤</h3>
                        <p class="text-gray-700 dark:text-gray-300">${message}</p>
                        <div class="mt-6 text-right">
                            <button id="modal-close-btn" class="bg-blue-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-blue-700 transition">ç¢ºèª</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
                setTimeout(() => {
                    modal.classList.remove('opacity-0');
                    modal.querySelector('div').classList.remove('scale-95');
                }, 10);
                document.getElementById('modal-close-btn').addEventListener('click', () => {
                    modal.classList.add('opacity-0');
                    modal.querySelector('div').classList.add('scale-95');
                    setTimeout(() => modal.remove(), 300);
                });
            }

            // --- é ç±¤åˆ‡æ›é‚è¼¯ ---
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.dataset.tab;
                    tabButtons.forEach(btn => {
                        btn.classList.remove('active-tab', 'text-indigo-600', 'dark:text-indigo-400', 'border-indigo-500');
                        btn.classList.add('inactive-tab');
                    });
                    button.classList.add('active-tab', 'text-indigo-600', 'dark:text-indigo-400', 'border-indigo-500');
                    button.classList.remove('inactive-tab');
                    tabContents.forEach(content => {
                        content.id === targetTab ? content.classList.remove('hidden') : content.classList.add('hidden');
                    });
                });
            });

            // --- å·¥å…· 1: AI æ™¶ç‰‡ LCA è©•ä¼°é‚è¼¯ ---
            const gpuData = {
                "A100": { tdp_watt: 400, cradle_to_gate_kg: 120, water_L_per_year: [1000, 6000], e_waste_kg: 2.5 },
                "H100": { tdp_watt: 700, cradle_to_gate_kg: 164, water_L_per_year: [2000, 8000], e_waste_kg: 3 },
                "B200": { tdp_watt: 1100, cradle_to_gate_kg: 284, water_L_per_year: [3500, 10000], e_waste_kg: 2.5 },
                "B300": { tdp_watt: 1300, cradle_to_gate_kg: 300, water_L_per_year: [3500, 15000], e_waste_kg: 3.5 }
            };
            const lcaDailyEquivalents = {
                flight: { name: 'è¶Ÿå°åŒ—-æ±äº¬èˆªç­', value: 0.4, icon: `âœˆï¸`, tooltip: 'ä¸€è¶Ÿå°åŒ—é£›å¾€æ±äº¬çš„ä¾†å›èˆªç­æ‰€ç”¢ç”Ÿçš„ç¢³æ’ã€‚' },
                car: { name: 'è¼›æ±½è»Šå¹´æ’ç¢³', value: 1.9, icon: `ğŸš—`, tooltip: 'ä¸€è¼›æ™®é€šå®¶ç”¨æ±½è»Šè¡Œé§›ä¸€å¹´æ‰€ç”¢ç”Ÿçš„å¹³å‡ç¢³æ’ã€‚' },
                tree: { name: 'æ£µæ¨¹å¹´å¸ç¢³é‡', value: 0.012, icon: `ğŸŒ³`, tooltip: 'ä¸€æ£µæ¨¹ä¸€å¹´æ‰€èƒ½å¸æ”¶çš„äºŒæ°§åŒ–ç¢³ç¸½é‡ã€‚' },
                bento: { name: 'å€‹æ’éª¨ä¾¿ç•¶', value: 0.0015, icon: `ğŸ±`, tooltip: 'ä¸€å€‹æ’éª¨ä¾¿ç•¶å¾ç”Ÿç”¢åˆ°æ¶ˆè²»æ‰€ç”¢ç”Ÿçš„ç¢³æ’ã€‚' },
            };
            let carbonChartInstance = null;
            function updateChart(operational, embodied) {
                const ctx = document.getElementById('carbonChart').getContext('2d');
                if (carbonChartInstance) carbonChartInstance.destroy();
                carbonChartInstance = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['ç‡Ÿé‹ç¢³æ’', 'éš±å«ç¢³æ’'],
                        datasets: [{ data: [operational, embodied], backgroundColor: ['#3B82F6', '#14B8A6'], borderColor: document.body.classList.contains('dark') ? '#1f2937' : '#FFFFFF', borderWidth: 4 }]
                    },
                    options: {
                        responsive: true, cutout: '70%',
                        plugins: {
                            legend: { position: 'bottom', labels: { color: document.body.classList.contains('dark') ? '#D1D5DB' : '#4B5563' } },
                            title: { display: true, text: 'ç¢³è¶³è·¡çµ„æˆ (tCOâ‚‚eq)', color: document.body.classList.contains('dark') ? '#F9FAFB' : '#1F2937', font: { size: 16 } }
                        }
                    },
                });
            }
            document.getElementById('calculateLcaBtn').addEventListener('click', () => {
                const gpuChip = document.getElementById('gpuChip').value;
                const lifespan = parseFloat(document.getElementById('lifespan').value);
                const utilization = parseFloat(document.getElementById('utilization').value);
                const carbonIntensity = parseFloat(document.getElementById('carbonIntensity').value);
                if (isNaN(lifespan) || isNaN(utilization) || isNaN(carbonIntensity) || lifespan <= 0 || utilization < 0 || utilization > 24 || carbonIntensity <= 0) {
                    showAppModal("è«‹è¼¸å…¥æœ‰æ•ˆçš„æ•¸å€¼ã€‚ä½¿ç”¨å¹´é™å’Œç¢³å¼·åº¦å¿…é ˆå¤§æ–¼ 0ï¼Œæ¯æ—¥é‹ä½œæ™‚æ•¸éœ€ä»‹æ–¼ 0 åˆ° 24 ä¹‹é–“ã€‚");
                    return;
                }
                const data = gpuData[gpuChip];
                const totalHours = lifespan * 365 * utilization;
                const totalKWH = (data.tdp_watt * totalHours) / 1000;
                const operationalCo2 = (totalKWH * carbonIntensity) / 1000;
                const embodiedCo2 = data.cradle_to_gate_kg / 1000;
                const totalCo2 = operationalCo2 + embodiedCo2;
                const avgWater = (data.water_L_per_year[0] + data.water_L_per_year[1]) / 2;
                const totalWater = avgWater * lifespan;
                const eWaste = data.e_waste_kg;
                document.getElementById('totalCo2').innerHTML = `${totalCo2.toFixed(2)} <span class="text-base font-normal">tCOâ‚‚eq</span>`;
                document.getElementById('operationalCo2').innerHTML = `${operationalCo2.toFixed(2)} <span class="text-base font-normal">tCOâ‚‚eq</span>`;
                document.getElementById('embodiedCo2').innerHTML = `${embodiedCo2.toFixed(2)} <span class="text-base font-normal">tCOâ‚‚eq</span>`;
                document.getElementById('waterConsumption').innerHTML = `${totalWater.toFixed(0).toLocaleString('zh-TW')} <span class="text-base font-normal">L</span>`;
                document.getElementById('eWaste').innerHTML = `${eWaste.toFixed(2)} <span class="text-base font-normal">kg</span>`;
                updateChart(operationalCo2, embodiedCo2);
                const equivalentsContainer = document.getElementById('lca-equivalents');
                equivalentsContainer.innerHTML = '';
                for (const key in lcaDailyEquivalents) {
                    const item = lcaDailyEquivalents[key];
                    const equivalentAmount = totalCo2 / item.value;
                    equivalentsContainer.innerHTML += `<div class="bg-white dark:bg-gray-700 p-3 rounded-lg text-center transition duration-300 ease-in-out shadow-sm hover:shadow-lg transform hover:-translate-y-1 border dark:border-gray-600"><div class="tooltip"><span class="text-3xl">${item.icon}</span><span class="tooltiptext">${item.tooltip} ç¢³æ’ï¼š${item.value.toFixed(4).replace(/0+$/, '').replace(/\.$/, '')} tCOâ‚‚eq</span></div><p class="text-xl font-bold text-gray-800 dark:text-gray-200 mt-2">${Math.round(equivalentAmount).toLocaleString('zh-TW')}</p><p class="text-xs text-gray-600 dark:text-gray-400 mt-1">${item.name}</p></div>`;
                }
                 document.getElementById('lca-results-container').scrollIntoView({ behavior: 'smooth' });
            });

            // --- å·¥å…· 2: LLM è¨“ç·´ç¢³æ’è¨ˆç®—å™¨é‚è¼¯ ---
            const modelPresetSelect = document.getElementById('modelPreset');
            const modelTypeSelect = document.getElementById('modelType');
            const baseModelParamsContainer = document.getElementById('baseModelParamsContainer');
            const calculateTrainingBtn = document.getElementById('calculateTrainingBtn');
            const trainingResultsContainer = document.getElementById('training-results-container');
            const deviceTypeSelect = document.getElementById('deviceType');
            const modelPresets = {
                'GPT3': { name: 'GPT-3 (175B)', type: 'dense', params: 175, baseParams: '', tokens: 300, deviceType: 'V100', deviceNum: 10000 },
                'GPT4': { name: 'GPT-4 (1.8T)', type: 'MoE', params: 1800, baseParams: 111, tokens: 13000, deviceType: 'A100', deviceNum: 25000 },
                'custom': { name: 'è‡ªè¨‚æ¨¡å‹' },
            };
            const hardwarePresets = {
                'V100': { peakTFLOPs: 125, systemPower: 330 }, 'A100': { peakTFLOPs: 312, systemPower: 550 },
                'H100': { peakTFLOPs: 1979, systemPower: 800 }, 'TPUv3': { peakTFLOPs: 123, systemPower: 288 },
                'TPUv4': { peakTFLOPs: 275, systemPower: 250 }, 'custom': { peakTFLOPs: 125, systemPower: 330 }
            };
            const trainingDailyEquivalents = {
                flight: { name: 'è¶Ÿå°åŒ—-æ±äº¬èˆªç­', value: 0.4, icon: `âœˆï¸`, tooltip: 'ä¸€è¶Ÿå°åŒ—é£›å¾€æ±äº¬çš„ä¾†å›èˆªç­æ‰€ç”¢ç”Ÿçš„ç¢³æ’ã€‚' },
                car: { name: 'è¼›æ±½è»Šå¹´æ’ç¢³', value: 1.9, icon: `ğŸš—`, tooltip: 'ä¸€è¼›æ™®é€šå®¶ç”¨æ±½è»Šè¡Œé§›ä¸€å¹´æ‰€ç”¢ç”Ÿçš„å¹³å‡ç¢³æ’ã€‚' },
                tree: { name: 'æ£µæ¨¹å¹´å¸ç¢³é‡', value: 0.012, icon: `ğŸŒ³`, tooltip: 'ä¸€æ£µæ¨¹ä¸€å¹´æ‰€èƒ½å¸æ”¶çš„äºŒæ°§åŒ–ç¢³ç¸½é‡ã€‚' },
                bento: { name: 'å€‹æ’éª¨ä¾¿ç•¶', value: 0.0015, icon: `ğŸ±`, tooltip: 'ä¸€å€‹æ’éª¨ä¾¿ç•¶å¾ç”Ÿç”¢åˆ°æ¶ˆè²»æ‰€ç”¢ç”Ÿçš„ç¢³æ’ã€‚' },
            };
            for (const key in modelPresets) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = modelPresets[key].name;
                modelPresetSelect.appendChild(option);
            }
            modelPresetSelect.addEventListener('change', (e) => {
                const selectedModelKey = e.target.value;
                const preset = modelPresets[selectedModelKey];
                const isCustom = selectedModelKey === 'custom';

                if (!isCustom) {
                    document.getElementById('modelType').value = preset.type;
                    document.getElementById('parametersB').value = preset.params;
                    document.getElementById('tokensB').value = preset.tokens;
                    document.getElementById('deviceType').value = preset.deviceType;
                    document.getElementById('deviceNum').value = preset.deviceNum;
                    deviceTypeSelect.dispatchEvent(new Event('change'));
                    
                    if (preset.type === 'MoE') {
                        document.getElementById('baseModelParamsB').value = preset.baseParams;
                    } else {
                        document.getElementById('baseModelParamsB').value = '';
                    }
                }
                
                document.getElementById('modelType').disabled = !isCustom;
                document.getElementById('parametersB').disabled = !isCustom;
                document.getElementById('baseModelParamsB').disabled = !isCustom;
                document.getElementById('tokensB').disabled = !isCustom;
                
                const currentModelType = document.getElementById('modelType').value;
                baseModelParamsContainer.classList.toggle('hidden', currentModelType !== 'MoE');
            });
            modelPresetSelect.value = 'GPT3';
            modelPresetSelect.dispatchEvent(new Event('change'));

            modelTypeSelect.addEventListener('change', () => baseModelParamsContainer.classList.toggle('hidden', modelTypeSelect.value !== 'MoE'));
            deviceTypeSelect.addEventListener('change', (e) => {
                document.getElementById('systemPower').value = (hardwarePresets[e.target.value] || hardwarePresets['custom']).systemPower;
            });
            calculateTrainingBtn.addEventListener('click', () => {
                const inputs = getTrainingInputs();
                if (!validateTrainingInputs(inputs)) return;
                displayTrainingResults(calculateTrainingCarbon(inputs));
                trainingResultsContainer.classList.remove('hidden');
                trainingResultsContainer.scrollIntoView({ behavior: 'smooth' });
            });
            function getTrainingInputs() {
                return {
                    modelType: modelTypeSelect.value, parametersB: parseFloat(document.getElementById('parametersB').value),
                    baseModelParamsB: parseFloat(document.getElementById('baseModelParamsB').value), tokensB: parseFloat(document.getElementById('tokensB').value),
                    deviceType: deviceTypeSelect.value, deviceNum: parseInt(document.getElementById('deviceNum').value),
                    systemPower: parseFloat(document.getElementById('systemPower').value), hardwareEfficiency: parseFloat(document.getElementById('hardwareEfficiency').value),
                    pue: parseFloat(document.getElementById('pue').value), co2eqkwh: parseFloat(document.getElementById('trainingCo2eqkwh').value),
                    gpuCostPerHour: parseFloat(document.getElementById('gpuCostPerHour').value),
                };
            }
            function validateTrainingInputs(inputs) {
                for (const key in inputs) {
                    if (inputs.modelType === 'dense' && key === 'baseModelParamsB') continue;
                    if (['modelType', 'deviceType'].includes(key)) continue;
                    if (isNaN(inputs[key])) { showAppModal(`è«‹è¼¸å…¥æœ‰æ•ˆçš„æ•¸å€¼: ${key}`); return false; }
                    if (inputs[key] <= 0 && key !== 'baseModelParamsB') { showAppModal(`æ•¸å€¼ "${key}" å¿…é ˆå¤§æ–¼ 0`); return false; }
                }
                if (inputs.modelType === 'MoE' && inputs.baseModelParamsB <= 0) { showAppModal(`MoE æ¨¡å‹çš„åŸºç¤æ¨¡å‹åƒæ•¸å¿…é ˆå¤§æ–¼ 0`); return false; }
                return true;
            }
            function calculateTrainingCarbon(inputs) {
                const activeParamsB = inputs.modelType === 'MoE' ? inputs.baseModelParamsB : inputs.parametersB;
                const totalFLOPs = 6 * activeParamsB * 1e9 * inputs.tokensB * 1e9;
                const TFLOPsPerSecond = hardwarePresets[inputs.deviceType].peakTFLOPs * (inputs.hardwareEfficiency / 100);
                const trainingSeconds = totalFLOPs / (inputs.deviceNum * TFLOPsPerSecond * 1e12);
                const trainingDays = trainingSeconds / 86400;
                const totalPowerKW = (inputs.systemPower * inputs.deviceNum) / 1000;
                const totalEnergyKWh = totalPowerKW * (trainingDays * 24) * inputs.pue;
                return {
                    operationalCo2: (totalEnergyKWh * inputs.co2eqkwh) / 1000,
                    trainingDays: trainingDays,
                    totalEnergyMWh: totalEnergyKWh / 1000,
                    trainingCost: trainingDays * 24 * inputs.deviceNum * inputs.gpuCostPerHour,
                };
            }
            function displayTrainingResults(results) {
                animateValue(document.getElementById('operationalCo2Display'), 0, results.operationalCo2, 1500, 'tCOâ‚‚eq');
                animateValue(document.getElementById('totalEnergyMWhDisplay'), 0, results.totalEnergyMWh, 1500, 'MWh');
                animateValue(document.getElementById('trainingCostDisplay'), 0, results.trainingCost, 1500, '', true);
                animateValue(document.getElementById('trainingDurationDisplay'), 0, results.trainingDays, 1500, '', false, true);
                const equivalentsContainer = document.getElementById('training-equivalents');
                equivalentsContainer.innerHTML = '';
                for (const key in trainingDailyEquivalents) {
                    const item = trainingDailyEquivalents[key];
                    const equivalentAmount = results.operationalCo2 / item.value;
                    equivalentsContainer.innerHTML += `<div class="bg-white dark:bg-gray-700 p-3 rounded-lg text-center transition duration-300 ease-in-out shadow-sm hover:shadow-lg transform hover:-translate-y-1 border dark:border-gray-600"><div class="tooltip"><span class="text-3xl">${item.icon}</span><span class="tooltiptext">${item.tooltip} ç¢³æ’ï¼š${item.value.toFixed(4).replace(/0+$/, '').replace(/\.$/, '')} tCOâ‚‚eq</span></div><p class="text-xl font-bold text-gray-800 dark:text-gray-200 mt-2">${Math.round(equivalentAmount).toLocaleString('zh-TW')}</p><p class="text-xs text-gray-600 dark:text-gray-400 mt-1">${item.name}</p></div>`;
                }
            }
            function animateValue(element, start, end, duration, unit, isCurrency = false, isDuration = false) {
                let startTimestamp = null;
                const step = timestamp => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    const currentValue = progress * (end - start) + start;
                    if (isCurrency) element.textContent = `$${Math.floor(currentValue).toLocaleString('en-US')}`;
                    else if (isDuration) element.textContent = currentValue < 365 ? `${currentValue.toFixed(2)} å¤©` : `${(currentValue / 365).toFixed(2)} å¹´`;
                    else element.innerHTML = `${currentValue.toFixed(2)} <span class="text-base font-normal">${unit}</span>`;
                    if (progress < 1) window.requestAnimationFrame(step);
                };
                window.requestAnimationFrame(step);
            }

            // --- å·¥å…· 3: LLM æ¨è«–ç¢³æ’è¨ˆç®—å™¨é‚è¼¯ ---
            const infModelPresetSelect = document.getElementById('inf-modelPreset');
            const infCustomModelSection = document.getElementById('inf-customModelSection');
            const infModelTypeSelect = document.getElementById('inf-modelType');
            const infBaseModelParamsContainer = document.getElementById('inf-baseModelParamsContainer');
            const infCalculateBtn = document.getElementById('calculateInferenceBtn');
            const infResultsContainer = document.getElementById('inf-results-container');
            const infDeviceTypeSelect = document.getElementById('inf-deviceType');
            const infDeviceNumInput = document.getElementById('inf-deviceNum');
            const infSystemPowerInput = document.getElementById('inf-systemPower');
            const infModelPresets = {
                'GPT3': { parametersB: 175, type: 'dense', baseModelParamsB: null, deviceType: 'A100', deviceNum: 8, systemPower: 550 },
                'GPT4': { parametersB: 1800, type: 'MoE', baseModelParamsB: 200, deviceType: 'A100', deviceNum: 16, systemPower: 550 },
                'custom': { parametersB: 175, type: 'dense', baseModelParamsB: null, deviceType: 'V100', deviceNum: 1, systemPower: 330 } // Provide defaults for custom
            };
            const infHardwarePresets = {
                'V100': { peakTFLOPs: 125, systemPower: 330 }, 'H100': { peakTFLOPs: 1979, systemPower: 800 },
                'A100': { peakTFLOPs: 312, systemPower: 550 }, 'TPUv3': { peakTFLOPs: 123, systemPower: 288 },
                'TPUv4': { peakTFLOPs: 275, systemPower: 250 }, 'custom': { peakTFLOPs: 125, systemPower: 330 }
            };
            const infDailyEquivalents_g = {
                'sms': { name: 'å€‹ç°¡è¨Š', value: 0.014, icon: `ğŸ’¬`, tooltip: 'ä¸€å‰‡ç°¡è¨Šçš„å¹³å‡ç¢³æ’ã€‚' },
                'google_search': { name: 'æ¬¡ Google æœå°‹', value: 0.2, icon: `ğŸ”`, tooltip: 'ä¸€æ¬¡ Google æœå°‹çš„å¹³å‡ç¢³æ’ã€‚' },
                'youtube_stream': { name: 'å°æ™‚ YouTube ä¸²æµ', value: 10, icon: `â–¶ï¸`, tooltip: 'è§€çœ‹ä¸€å°æ™‚ YouTube å½±ç‰‡çš„å¹³å‡ç¢³æ’ã€‚' },
                'video_conference': { name: 'å°æ™‚ç·šä¸Šæœƒè­°', value: 12, icon: `ğŸ’»`, tooltip: 'ä¸€å°æ™‚ç·šä¸Šè¦–è¨Šæœƒè­°çš„å¹³å‡ç¢³æ’ã€‚' },
            };
            
            infModelPresetSelect.addEventListener('change', (e) => {
                const presetKey = e.target.value;
                const isCustom = presetKey === 'custom';
                const model = isCustom ? infModelPresets['GPT3'] : infModelPresets[presetKey]; // Use GPT3 as base for custom

                document.getElementById('inf-parametersB').value = model.parametersB;
                infModelTypeSelect.value = model.type;
                if (model.type === 'MoE') {
                    document.getElementById('inf-baseModelParamsB').value = model.baseModelParamsB;
                }
                infDeviceTypeSelect.value = model.deviceType;
                infDeviceNumInput.value = model.deviceNum;
                infSystemPowerInput.value = model.systemPower;
                infDeviceTypeSelect.dispatchEvent(new Event('change'));

                infCustomModelSection.classList.toggle('hidden', !isCustom);
                document.getElementById('inf-modelType').disabled = !isCustom;
                document.getElementById('inf-parametersB').disabled = !isCustom;
                document.getElementById('inf-baseModelParamsB').disabled = !isCustom;
                
                const currentModelType = infModelTypeSelect.value;
                infBaseModelParamsContainer.classList.toggle('hidden', currentModelType !== 'MoE');
            });

            infModelTypeSelect.addEventListener('change', (e) => {
                infBaseModelParamsContainer.classList.toggle('hidden', e.target.value !== 'MoE');
            });

            infDeviceTypeSelect.addEventListener('change', (e) => {
                if (e.target.value !== 'custom') {
                    infSystemPowerInput.value = infHardwarePresets[e.target.value].systemPower;
                }
            });

            infCalculateBtn.addEventListener('click', () => {
                const inputs = getInfInputs();
                if (!validateInfInputs(inputs)) return;
                displayInfResults(calculateInferenceCarbon(inputs));
                infResultsContainer.classList.remove('hidden');
                infResultsContainer.scrollIntoView({ behavior: 'smooth' });
            });

            function getInfInputs() {
                return {
                    modelType: infModelTypeSelect.value,
                    parametersB: parseFloat(document.getElementById('inf-parametersB').value),
                    baseModelParamsB: parseFloat(document.getElementById('inf-baseModelParamsB').value),
                    tokensT: parseFloat(document.getElementById('inf-tokensT').value),
                    deviceType: infDeviceTypeSelect.value,
                    deviceNum: parseInt(infDeviceNumInput.value),
                    systemPower: parseFloat(infSystemPowerInput.value),
                    hardwareEfficiency: parseFloat(document.getElementById('inf-hardwareEfficiency').value),
                    pue: parseFloat(document.getElementById('inf-pue').value),
                    co2eqkwh: parseFloat(document.getElementById('inf-co2eqkwh').value),
                };
            }

            function validateInfInputs(inputs) {
                for (const key in inputs) {
                    if (key === 'baseModelParamsB' && inputs.modelType !== 'MoE') continue;
                    if (['modelType', 'deviceType'].includes(key)) continue;
                    if (isNaN(inputs[key])) { showAppModal(`è«‹è¼¸å…¥æœ‰æ•ˆçš„æ•¸å€¼: ${key}`); return false; }
                    if (inputs[key] < 0) { showAppModal(`æ•¸å€¼ "${key}" å¿…é ˆå¤§æ–¼ç­‰æ–¼ 0`); return false; }
                }
                if (inputs.pue < 1) { showAppModal(`PUE å¿…é ˆå¤§æ–¼ç­‰æ–¼ 1`); return false; }
                return true;
            }

            function calculateInferenceCarbon(inputs) {
                const activeParamsB = inputs.modelType === 'MoE' ? inputs.baseModelParamsB : inputs.parametersB;
                const totalZettaFLOPs = 2 * activeParamsB * inputs.tokensT;
                const totalFLOPs = totalZettaFLOPs * 1e21;
                const TFLOPsPerSecond = infHardwarePresets[inputs.deviceType].peakTFLOPs * (inputs.hardwareEfficiency / 100);
                const inferenceSeconds = totalFLOPs / (inputs.deviceNum * TFLOPsPerSecond * 1e12);
                const totalPowerKW = (inputs.systemPower * inputs.deviceNum) / 1000;
                const totalEnergyKWh = totalPowerKW * (inferenceSeconds / 3600) * inputs.pue;
                return { totalCo2_g: totalEnergyKWh * inputs.co2eqkwh, totalEnergyKWh, totalTimeSeconds: inferenceSeconds };
            }

            function displayInfResults(results) {
                document.getElementById('inf-totalCo2').textContent = results.totalCo2_g.toFixed(4);
                const { totalTimeSeconds } = results;
                let timeString;
                if (totalTimeSeconds < 60) timeString = `${totalTimeSeconds.toFixed(2)} ç§’`;
                else if (totalTimeSeconds < 3600) timeString = `${(totalTimeSeconds / 60).toFixed(2)} åˆ†é˜`;
                else timeString = `${(totalTimeSeconds / 3600).toFixed(2)} å°æ™‚`;
                document.getElementById('inf-timeDisplay').textContent = timeString;
                document.getElementById('inf-energyDisplay').textContent = `${(results.totalEnergyKWh * 1000).toFixed(2)} Wh`;
                const equivalentsContainer = document.getElementById('inf-equivalents');
                equivalentsContainer.innerHTML = '';
                for (const key in infDailyEquivalents_g) {
                    const item = infDailyEquivalents_g[key];
                    const equivalentAmount = results.totalCo2_g / item.value;
                    const formattedAmount = equivalentAmount < 1 && equivalentAmount > 0 ? equivalentAmount.toFixed(4) : Math.round(equivalentAmount).toLocaleString('zh-TW');
                    equivalentsContainer.innerHTML += `<div class="bg-white dark:bg-gray-700 p-3 rounded-lg text-center transition duration-300 ease-in-out shadow-sm hover:shadow-lg transform hover:-translate-y-1 border dark:border-gray-600"><div class="tooltip"><span class="text-3xl">${item.icon}</span><span class="tooltiptext">${item.tooltip} ç¢³æ’ï¼š${item.value.toFixed(4).replace(/0+$/, '').replace(/\.$/, '')} gCOâ‚‚eq</span></div><p class="text-xl font-bold text-gray-800 dark:text-gray-200 mt-2">${formattedAmount}</p><p class="text-xs text-gray-600 dark:text-gray-400 mt-1">${item.name}</p></div>`;
                }
            }
            infModelPresetSelect.dispatchEvent(new Event('change'));
        });
    </script>
</body>
</html>




